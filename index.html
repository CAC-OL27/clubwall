<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>ç¤¾å›¢é—®å·å¢™ Â· å®æ—¶ç‰ˆ</title>
    <style>
        /* ===== ä½ æœ€åˆè®¾è®¡çš„æ‰€æœ‰æ ·å¼ï¼Œå®Œå…¨ä¿ç•™ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #f6f9fc 0%, #eaf2f8 100%);
            padding: 2rem 1.5rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
        }

        .header {
            margin-bottom: 2.5rem;
            position: relative;
        }

        .header h1 {
            font-size: 2.1rem;
            font-weight: 700;
            color: #0b3b5c;
            border-left: 8px solid #1e88e5;
            padding-left: 20px;
            line-height: 1.2;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header h1 span {
            background: #1e88e5;
            color: white;
            font-size: 1rem;
            padding: 4px 12px;
            border-radius: 40px;
            font-weight: 500;
        }

        .subhead {
            color: #2c3e50;
            font-size: 1.1rem;
            margin-top: 12px;
            padding-left: 28px;
            border-bottom: 1px dashed #b0c4ce;
            padding-bottom: 12px;
        }

        .quest-list {
            display: flex;
            flex-direction: column;
            gap: 1.4rem;
        }

        .quest-card {
            background: #ffffff;
            border-radius: 28px;
            padding: 1.5rem 1.8rem;
            box-shadow: 0 10px 25px -8px rgba(0,50,80,0.12);
            border: 1px solid rgba(255,255,255,0.6);
            transition: transform 0.2s ease, box-shadow 0.25s ease;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .quest-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 22px 30px -12px rgba(30,136,229,0.2);
            border-color: #c3e0f2;
        }

        .card-index {
            font-size: 1.7rem;
            font-weight: 700;
            color: #1e88e5;
            line-height: 1;
            min-width: 38px;
            text-align: left;
            letter-spacing: -1px;
        }

        .card-content {
            flex: 1;
        }

        .survey-text {
            font-size: 1.06rem;
            line-height: 1.55;
            color: #1c2e3a;
            word-break: break-word;
            background: #fafcff;
            padding: 0.6rem 1rem;
            border-radius: 18px;
            border-left: 4px solid #90caf9;
        }

        .survey-text a {
            color: #0d47a1;
            font-weight: 600;
            text-decoration: none;
            border-bottom: 2px solid #ffb74d;
            padding: 2px 6px;
            background: #fff9c4;
            border-radius: 20px;
            transition: all 0.15s;
            display: inline-block;
        }

        .survey-text a:hover {
            background: #ffe082;
            border-bottom-color: #e65100;
            color: #1a237e;
        }

        .meta-foot {
            margin-top: 12px;
            display: flex;
            justify-content: space-between;
            color: #6b7b8b;
            font-size: 0.8rem;
            padding-left: 6px;
            border-top: 1px solid #deecf3;
            padding-top: 12px;
        }

        .footer-note {
            margin-top: 48px;
            text-align: center;
            color: #4f6f7f;
            font-size: 0.85rem;
            border-top: 1px solid #cbdae3;
            padding-top: 28px;
        }

        .submit-btn {
            display: inline-block;
            background: #1e88e5;
            color: white;
            padding: 12px 32px;
            border-radius: 60px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            transition: background 0.2s;
        }
        .submit-btn:hover {
            background: #1565c0;
        }

        @media (max-width: 550px) {
            body { padding: 1.5rem 1rem; }
            .header h1 { font-size: 1.8rem; }
            .quest-card { padding: 1.3rem 1.2rem; }
            .card-index { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                ğŸ“® ç¤¾å›¢é—®å·æ˜Ÿ 
                <span>å®æ—¶å¢™</span>
            </h1>
            <div class="subhead">
                âš¡ å„ç¤¾å›¢æœ€æ–°å‘å¸ƒçš„é—®å· Â· ç‚¹å‡»é“¾æ¥è·³è½¬é—®å·æ˜Ÿç›´æ¥ä½œç­”
                <i style="margin-left: 10px; background: #d4edf5; padding: 2px 8px; border-radius: 20px;">å®æ—¶æ›´æ–°</i>
            </div>
            <!-- ç¤¾å›¢æäº¤å…¥å£æŒ‰é’®ï¼ˆæŒ‡å‘ä½ çš„æ”¶é›†è¡¨é“¾æ¥ï¼‰ -->
            <a href="https://docs.qq.com/form/page/DSEdKR3haYktHSFNp" class="submit-btn" target="_blank">â• ç¤¾å›¢æäº¤æ–°é—®å·</a>
            <p style="margin-top: 8px; font-size: 0.9rem; color: #6b7b8b;">* æäº¤åéœ€ç®¡ç†å‘˜å®¡æ ¸ï¼Œå®¡æ ¸é€šè¿‡è‡ªåŠ¨æ˜¾ç¤ºåœ¨æ­¤é¡µ</p>
        </div>

        <!-- é—®å·åˆ—è¡¨åŒºåŸŸï¼ˆåŠ¨æ€æ¸²æŸ“ï¼‰ -->
        <div id="questList" class="quest-list">
            <p style="text-align: center; color: #6c757d;">â³ åŠ è½½é—®å·ä¸­...</p>
        </div>

        <div class="footer-note">
            ğŸ« æ ¡å›­ç¤¾å›¢é—®å·å‘å¸ƒä¸­å¿ƒ Â· æ•°æ®å®æ—¶åŒæ­¥ <br>
            Â© 2026 å­¦ç”Ÿç¤¾å›¢è”åˆä¼š
        </div>
    </div>

    <script>
        // ==================== é…ç½®åŒºï¼ˆå¿…å¡«ï¼‰====================
        const SHEET_ID = 'DSG1NZGF0RXhWc0pj';  // æ›¿æ¢æˆä½ çš„ sheetId
        const TAB_ID   = 'ss_3waav7';             // æ›¿æ¢æˆä½ çš„ tab
        
        // ç¤¾å›¢æäº¤è¡¨å•é“¾æ¥ï¼ˆå°†æŒ‰é’®ä¸­çš„é“¾æ¥ä¹Ÿæ›¿æ¢æˆä½ çš„æ”¶é›†è¡¨é“¾æ¥ï¼‰
        const SUBMIT_URL = 'https://docs.qq.com/form/page/DSEdKR3haYktHSFNp';  // â† æ›¿æ¢
        // ====================================================
//ã€è…¾è®¯æ–‡æ¡£ã€‘æ ¡å›­é—®å·é›†æ•£
//https://docs.qq.com/smartsheet/DSG1NZGF0RXhWc0pj?tab=ss_3waav7
        // æ„é€ è…¾è®¯æ–‡æ¡£å…¬å¼€APIåœ°å€
        const API_URL = `https://docs.qq.com/dop-api/opendata?sheetId=${SHEET_ID}&tab=${TAB_ID}`;

        // æ¸²æŸ“é—®å·åˆ—è¡¨
        async function loadSurveys() {
            const listEl = document.getElementById('questList');
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                
                // è…¾è®¯æ–‡æ¡£è¿”å›æ•°æ®ç»“æ„ï¼šdata.records æ•°ç»„
                const records = data.records || [];
                
                // æå–å­—æ®µå¹¶è¿‡æ»¤çŠ¶æ€ä¸ºâ€œå·²å‘å¸ƒâ€
                const surveys = records
                    .map(r => r.fields)          // å­—æ®µå¯¹è±¡
                    .filter(item => item.çŠ¶æ€ === 'å·²å‘å¸ƒ' || item.çŠ¶æ€ === 'å·²å‘å¸ƒ') // ä»…æ˜¾ç¤ºå·²å‘å¸ƒ
                    .sort((a, b) => {            // æŒ‰å‘å¸ƒæ—¶é—´å€’åº
                        const timeA = a.å‘å¸ƒæ—¶é—´ || '';
                        const timeB = b.å‘å¸ƒæ—¶é—´ || '';
                        return timeB.localeCompare(timeA);
                    });

                if (surveys.length === 0) {
                    listEl.innerHTML = '<p style="text-align: center; color: #6c757d;">ğŸ“­ æš‚æ— å·²å‘å¸ƒçš„é—®å·ï¼Œè¯·è€å¿ƒç­‰å¾…</p>';
                    return;
                }

                let html = '';
                surveys.forEach((item, index) => {
                    const time = item.å‘å¸ƒæ—¶é—´ || 'è¿‘æ—¥';
                    const club = item.ç¤¾å›¢åç§° || '';
                    const title = item.é—®å·æ ‡é¢˜ || '';
                    const link = item.é—®å·æ˜Ÿé“¾æ¥ || '#';
                    
                    html += `
                        <div class="quest-card">
                            <div class="card-index">${index + 1}.</div>
                            <div class="card-content">
                                <div class="survey-text">
                                    ï¼ˆ${time} ${club}ï¼š${title}ï¼ˆ<a href="${link}" target="_blank">ç‚¹å‡»è·³è½¬è‡³é—®å·æ˜Ÿç›¸å…³é“¾æ¥ä½œç­”</a>ï¼‰ï¼‰
                                </div>
                                <div class="meta-foot">
                                    <span>â³ å‘å¸ƒæ—¶é—´: ${time}</span>
                                    <span>ğŸ”— é—®å·æ˜Ÿ</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                listEl.innerHTML = html;
            } catch (error) {
                console.error(error);
                listEl.innerHTML = '<p style="color: #b02a37;">âŒ åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢æˆ–è”ç³»ç®¡ç†å‘˜</p>';
            }
        }

        // æ›´æ–°æŒ‰é’®é“¾æ¥ï¼ˆå°†HTMLé‡Œå†™æ­»çš„æ›¿æ¢ä¸ºé…ç½®çš„ï¼‰
        document.querySelector('.submit-btn').href = https://docs.qq.com/form/page/DSEdKR3haYktHSFNp;

        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        window.addEventListener('DOMContentLoaded', loadSurveys);
        // æ¯60ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡ï¼ˆå¯é€‰ï¼‰
        setInterval(loadSurveys, 60000);
    </script>
</body>

</html>


